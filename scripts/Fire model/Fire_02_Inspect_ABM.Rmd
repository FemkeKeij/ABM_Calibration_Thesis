---
title: "Fire_02_Explore_Model"
author: "Femke Keij S2647168"
date: '2022-07-21'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Clear working directory:
```{r}
rm(list = ls(all = TRUE)) 
```

Packages used:
```{r}
# for importing / working with tidy data
library(tidyverse)

# for arranging ggplots
library(patchwork)

# for ggplot aesthetics
library(directlabels)
library(RColorBrewer)
```

Random seed:
```{r}
set.seed(42)
```

Read in the data:
```{r}
# complete data set
fire_output <- read_csv(
  'data/processed/fire_full.csv')

# output data summary
fire_summary <- read_csv(
  'data/processed/fire_summary.csv')
# rename 'mean_burn_percentage' to 'burn_percentage'
fire_summary <- fire_summary %>%
  rename(burn_percentage = mean_burn_percentage)
```

# Visualising parameter space
Plot time series:
```{r}
p1 <- fire_summary %>%
  ggplot(mapping = aes(x = ticks, y = burn_percentage,
                       group = combination_number)) +
  geom_line(alpha = 0.2) +
  labs(y = 'percentage trees burned') +
  theme_minimal() +
  theme(panel.grid.minor = element_blank()) +
  facet_grid(~ directions,
             labeller = 'label_both')
```

Plot burn percentage at last tick as a function of density at start of simulation and number of directions:
```{r}
p2 <- fire_summary %>%
  group_by(combination_number) %>%
  filter(ticks == max(ticks)) %>%
  ggplot(mapping = (aes(x = density, y = burn_percentage,
                        group = as.factor(directions),
                        colour = as.factor(directions)))) +
  labs(x = 'tree density (%)',
       y = '% of burned trees at last tick',
       colour = 'number of directions') +
  geom_path (linewidth = 1) +
  theme_minimal()
```

Plot number of ticks against density:
```{r}
p3 <- fire_output %>%
  group_by(combination_number) %>%
  filter(ticks == max(ticks)) %>%
  ggplot(mapping = aes(x = density, y = ticks, 
                       colour = as.factor(directions))) +
  geom_point(alpha = 0.5) +
  labs(x = 'tree density (%)',
       y = 'number of ticks until fire extinguishes',
       colour = 'number of directions') +
  theme_minimal()
```

Plot both:
```{r}
p1 + p2

ggsave('figures/fire_parameterspace.pdf')
```

# Summary statistics
Some stats for the Fire model:
```{r}
summary(fire_output)
```

Check that the training and test data are similarly distributed:
```{r}
summary(fire_test)
```

```{r}
summary(fire_train)
```

The medians for the burn percentages are different.
```{r}
par(mfrow = c(1,3))
hist(fire_output$burn_percentage)
hist(fire_test$burn_percentage)
hist(fire_train$burn_percentage)
```
